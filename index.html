<!DOCTYPE html>
<html lang="en">

<head>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js">
  </script>

  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Undermining Democracy: The Shocking Discrepancy Between Form 45 and Form 47 A Blatant Attempt to Undermine
    PTI's Mandate</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.gstatic.com" rel="preconnect">
  <link
    href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
    rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.snow.css" rel="stylesheet">
  <link href="assets/vendor/quill/quill.bubble.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/simple-datatables/style.css" rel="stylesheet">

  <!-- Template Main CSS File -->
  <link href="assets/css/style.css" rel="stylesheet">
  <script>
    window.onload = function () {
      // Set default values for dropdowns
      document.getElementById('folderSelect').value = 'NAT'; // Default folder
      document.getElementById('fileSelect').value = '47'; // Default file
      // Load data with default values
      loadData();
    };

  </script>




</head>

<body>

  <!-- ======= Header ======= -->
  <header id="header" class="header fixed-top d-flex align-items-center">

    <div class="d-flex align-items-center justify-content-between">
      <a href="index.html" class="logo d-flex align-items-center">
        <img src="assets/img/logo.png" alt="">
        <span class="d-none d-xl-block" style="font-size:large;">Pakistan Elections 2024</span>
      </a>

    </div><!-- End Logo -->

    <div class="search-bar">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div><!-- End Search Bar -->

    <nav class="header-nav ms-auto">
      <ul class="d-flex align-items-center">

        <li class="nav-item d-block d-lg-none">
          <a class="nav-link nav-icon search-bar-toggle " href="#">
            <i class="bi bi-search"></i>
          </a>
        </li><!-- End Search Icon-->


      </ul>
    </nav><!-- End Icons Navigation -->

  </header><!-- End Header -->


  <main id="main" class="main">

    <div class="pagetitle">
      <h1>Form 45 Consolidated Results</h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="index.html">Home</a></li>
          <li class="breadcrumb-item active">Dashboard</li>
        </ol>
      </nav>
    </div><!-- End Page Title -->

    <section class="section dashboard">
      <div class="row">

        <!-- Left side columns -->
        <div class="col-lg-12">
          <div class="row">

            <!-- Sales Card -->
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card sales-card">
                <div class="card-body">
                  <h5 class="card-title">Seats <span>| Total</span></h5>

                  <div class="d-flex align-items-center">
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                      <img height="70" width="70" src="assets/img/national.png" alt="">
                    </div>
                    <div class="ps-3">
                      <h6>179</h6>
                      <span class="text-success small pt-1 fw-bold">67%</span> <span
                        class="text-muted small pt-2 ps-1">of total</span>

                    </div>
                  </div>
                </div>

              </div>
            </div><!-- End Sales Card -->

            <!-- Revenue Card -->
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card revenue-card">



                <div class="card-body">
                  <h5 class="card-title">ECP Announced <span>| Until now</span></h5>

                  <div class="d-flex align-items-center">
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                      <img height="70" width="70" src="assets/img/national.png" alt="">

                    </div>
                    <div class="ps-3">
                      <h6>92</h6>
                      <span class="text-success small pt-1 fw-bold">51%</span> <span
                        class="text-muted small pt-2 ps-1">secured</span>

                    </div>
                  </div>
                </div>

              </div>
            </div><!-- End Revenue Card -->

            <!-- Revenue Card -->
            <div class="col-xxl-4 col-md-4">
              <div class="card info-card revenue-card">



                <div class="card-body">
                  <h5 class="card-title">Disputed <span>| Until now</span></h5>

                  <div class="d-flex align-items-center">
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                      <img height="70" width="70" src="assets/img/national.png" alt="">

                    </div>
                    <div class="ps-3">
                      <h6>87</h6>
                      <span class="text-success small pt-1 fw-bold">49%</span> <span
                        class="text-muted small pt-2 ps-1">stolen for now</span>

                    </div>
                  </div>
                </div>

              </div>
            </div><!-- End Revenue Card -->

            <!-- Recent Sales -->
            <div class="col-12">
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="folderSelect" class="form-label">Assembly:</label>
                  <select id="folderSelect" class="form-select" onchange="loadData()">
                    <option value="NAT">National</option>
                    <option value="PUN">Punjab</option>
                    <option value="SIN">Sindh</option>
                    <option value="KPK">KPK</option>
                    <option value="BAL">Baluchistan</option>
                  </select>
                </div>
                <div class="col-md-6">
                  <label for="fileSelect" class="form-label">Halqa Number:</label>
                  <select id="fileSelect" class="form-select" onchange="loadData()">



                  </select>
                </div>
              </div>
              <!-- Form 45 card  , Form 47 card -->
              <div class="col-lg-12">
                <div class="row">

                  <div class="col-xxl-4 col-md-4">
                    <div class="card info-card revenue-card">



                      <div class="card-body">
                        <h5 class="card-title">Form 45<span> | Issued on polling day </span></h5>

                        <div class="d-flex align-items-center">

                          <div class="ps-3">
                            <div>
                              <span style="color: chocolate;" class="large pt-1 fw-bold" id="form45-party-01-name"></span> <span  style="color: chocolate;"
                                class="text fw-bold largept-2 ps-1" id="form45-party-01-stats"></span>
                            </div>
                            <div>
                              <span  class="small pt-1" id="form45-party-02-name"> </span> <span
                                class="small pt-2 ps-1" id="form45-party-02-stats"></span>
                            </div>


                          </div>

                        </div>
                      </div>

                    </div>
                  </div>

                  <div class="col-xxl-4  col-md-4">
                    <div class="card info-card revenue-card">



                      <div class="card-body">
                        <h5 class="card-title">Form 47<span> | Rigged by RO </span></h5>

                        <div class="d-flex align-items-center">

                          <div class="ps-3">
                            <div>
                              <span  style="color: chocolate;" class="large pt-1 fw-bold" id="winner-party-name"></span> <span  style="color: chocolate;"
                                class="large fw-bold pt-2 ps-1" id="winner-party-votes"></span>
                            </div>
                            <div>
                              <span class="small pt-1" id="runnerup-party-name"></span></span> <span
                                class="small pt-2 ps-1" id="runnerup-party-votes"></span></span>
                            </div>


                          </div>
                        </div>
                      </div>

                    </div>
                  </div>

                  <div class="col-xxl-4  col-md-4">
                    <div class="card info-card revenue-card">



                      <div class="card-body">
                        <h5 class="card-title">See the Evidence<span> </span></h5>

                        <div class="d-flex align-items-center">

                          <div class="ps-3">
                            <div>
                              <a href="" target="_blank" class="text-primary small pt-1 fw-medium" id="evidance-link">
                                <i class="bi bi-eye"></i> Click here to see
                                the all evidences </a>

                            </div>
                            <div>
                              <span class="text-danger small pt-1 fw-bold "></span> <span
                                class="fw-bold small pt-2 ps-1"></span>
                            </div>


                          </div>
                        </div>
                      </div>

                    </div>
                  </div>


                </div>
              </div>

              <div class="card recent-sales overflow-auto">

                <div class=" justify-content-center  align-items-center  m-auto mt-2">


                  <div id="loadingSpinner" class="spinner-border text-primary d-none" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                </div>

                <!-- Error Message -->
                <div id="errorMessage" class="text-danger mb-3"></div>
                <div class="card-body  table-main">


                  <h5 class="card-title">Results <span>|</span></h5>

                </div>

              </div>
            </div><!-- End Recent Sales -->


          </div>
          <script>

            function loadData() {

              let ListedData = {
                NAT: [{
                  name: "47",
                  value: "47"
                },
                {
                  name: "48",
                  value: "48"
                }, {
                  name: "57",
                  value: "57"
                },
                {
                  name: "106",
                  value: "106"
                },
                {
                  name: "148",
                  value: "148"
                }, {
                  name: "151",
                  value: "151"
                }, {
                  name: "250",
                  value: "250"
                }],
                KPK: [
                  {
                    name: "None",
                    value: "None"
                  },
                  {
                    name: "79",
                    value: "79"
                  },


                ]

              }




              const ElectionData = {
                NAT47: {
                  link: "https://drive.google.com/drive/folders/1-M4_xA7tQlHPGk9G_WprHWv3CoZ2gMPM?usp=drive_link",
                  winnerParty: "PMLN",
                  winnerPartyVotes: "102502",
                  runnerUpParty: "PTI",
                  runnerUpPartyVotes: "86396"
                },


                NAT48: {
                  link: "https://drive.google.com/drive/folders/1a7FzCHfEKUIWV1SXbZdWuvdZVpbUaXRa",
                  winnerParty: "PMLN",
                  winnerPartyVotes: "69699",
                  runnerUpParty: "PTI",
                  runnerUpPartyVotes: "59851"
                },


                NAT57: {
                  link: "https://drive.google.com/drive/folders/1wrWkwHB8LS7ZfZUJ7NiOJ6tdYhcBbFps",
                  winnerParty: "PMLN",
                  winnerPartyVotes: "83331",
                  runnerUpParty: "PTI",
                  runnerUpPartyVotes: "56789"
                },


                NAT106: {
                  link: "https://drive.google.com/drive/folders/1zZ-Kh4G75-ALhB8Mel9Wspo9dY3DaZtC",
                  winnerParty: "PMLN",
                  winnerPartyVotes: "137629",
                  runnerUpParty: "PTI",
                  runnerUpPartyVotes: "136924"
                },


                NAT148: {
                  link: "https://drive.google.com/drive/folders/1SI8gtiMs22Y9hHHX2m3bk5JG-omQGLvP",
                  winnerParty: "PPP",
                  winnerPartyVotes: "67326",
                  runnerUpParty: "PTI",
                  runnerUpPartyVotes: "67033"
                },


                NAT151: {
                  link: "https://drive.google.com/drive/folders/1s1ZQyV3A08yDQtOkqYeQHM5FjeKZnYne",
                  winnerParty: "PPP",
                  winnerPartyVotes: "79080",
                  runnerUpParty: "PTI",
                  runnerUpPartyVotes: "71649"
                },


                NAT250: {
                  link: "https://drive.google.com/drive/folders/1nl1HKj_Rzl5D96VQ6KbYPkLG730HoFXK",
                  winnerParty: "MQMP",
                  winnerPartyVotes: "79925",
                  runnerUpParty: "PTI",
                  runnerUpPartyVotes: "37629"
                }



              }

              const selectedFolder = document.getElementById('folderSelect').value;
              const selectedFile = document.getElementById('fileSelect').value;

              fileSelect.innerHTML = "";

              ListedData[selectedFolder]?.forEach(item => {
                let option = document.createElement('option');
                option.value = item.value;
                option.text = item.name;
                fileSelect.appendChild(option);

              });


              for (var i = 0; i < fileSelect.options.length; i++) {
                if (fileSelect.options[i].value === selectedFile) {
                  // Set the selectedIndex to the index of the matching option
                  fileSelect.selectedIndex = i;
                  break;
                }
              }


              const url = `assets/xls/${selectedFolder}/${selectedFile ? selectedFile : "47"}.xlsx`;

              // Show loading spinner
              const loadingSpinner = document.getElementById('loadingSpinner');
              loadingSpinner.classList.remove('d-none');

              const evidanceLink = document.getElementById('evidance-link');
              evidanceLink.href = ElectionData[`${selectedFolder}${selectedFile}`] ? ElectionData[`${selectedFolder}${selectedFile}`]?.link : "#"

              const winnerPartyName = document.getElementById('winner-party-name');
              winnerPartyName.innerHTML = ElectionData[`${selectedFolder}${selectedFile}`] ? ElectionData[`${selectedFolder}${selectedFile}`]?.winnerParty : ""

              const winnerPartyVotes = document.getElementById('winner-party-votes');
              winnerPartyVotes.innerHTML = ElectionData[`${selectedFolder}${selectedFile}`] ? ElectionData[`${selectedFolder}${selectedFile}`]?.winnerPartyVotes : ""

              const runnerupPartyName = document.getElementById('runnerup-party-name');
              runnerupPartyName.innerHTML = ElectionData[`${selectedFolder}${selectedFile}`] ? ElectionData[`${selectedFolder}${selectedFile}`]?.runnerUpParty : ""

              const runnerupPartyVotes = document.getElementById('runnerup-party-votes');
              runnerupPartyVotes.innerHTML = ElectionData[`${selectedFolder}${selectedFile}`] ? ElectionData[`${selectedFolder}${selectedFile}`]?.runnerUpPartyVotes : ""


              fetch(url)
                .then(response => {
                  if (!response.ok) {
                    throw new Error('File not found or error fetching data');
                  }
                  return response.blob();
                })
                .then(blob => {
                  return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = function (event) {
                      const data = new Uint8Array(event.target.result);
                      const workbook = XLSX.read(data, { type: 'array' });
                      const firstSheetName = workbook.SheetNames[0];
                      const worksheet = workbook.Sheets[firstSheetName];
                      const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                      resolve(jsonData);
                    };
                    reader.onerror = function (error) {
                      reject(error);
                    };
                    reader.readAsArrayBuffer(blob);
                  });
                })
                .then(data => {
                  displayData(data);
                  // Hide loading spinner
                  loadingSpinner.classList.add('d-none');
                  const errorMessage = document.getElementById('errorMessage');
                  errorMessage.textContent = ''; // Clear error message

                })
                .catch(error => {
                  clearTableData();
                  console.error('Error fetching Excel:', error);
                  // Display error message
                  const errorMessage = document.getElementById('errorMessage');
                  errorMessage.textContent = 'No data found. Please try again later.';
                  // Hide loading spinner
                  loadingSpinner.classList.add('d-none');
                });
            }

            function clearTableData() {
              const recentSalesSection = document.querySelector('.table-main');
              recentSalesSection.innerHTML = ''; // Clear table data
            }

            function findMaxNumberWithIndex(array) {
              let maxNumber = -Infinity; // Initialize maxNumber with negative infinity
              let maxIndex = -1; // Initialize maxIndex with -1

              // Iterate through the array
              array.forEach((element, index) => {
                // Check if the element is a valid number and greater than the current maxNumber
                if (!isNaN(element) && typeof element === 'number' && element > maxNumber) {
                  maxNumber = element; // Update maxNumber if the condition is met
                  maxIndex = index; // Update maxIndex with the current index
                }
              });

              return { maxNumber, maxIndex }; // Return an object containing both maxNumber and maxIndex
            }

            function findSecondMaxNumberWithIndex(array) {
              let maxNumber = -Infinity; // Initialize maxNumber with negative infinity
              let maxIndex = -1; // Initialize maxIndex with -1
              let secondMaxNumber = -Infinity; // Initialize secondMaxNumber with negative infinity
              let secondMaxIndex = -1; // Initialize secondMaxIndex with -1

              // Iterate through the array
              array.forEach((element, index) => {
                // Check if the element is a valid number and greater than the current maxNumber
                if (!isNaN(element) && typeof element === 'number') {
                  if (element > maxNumber) {
                    secondMaxNumber = maxNumber;
                    secondMaxIndex = maxIndex;
                    maxNumber = element;
                    maxIndex = index;
                  } else if (element > secondMaxNumber && element !== maxNumber) {
                    secondMaxNumber = element;
                    secondMaxIndex = index;
                  }
                }
              });

              return { secondMaxNumber, secondMaxIndex }; // Return an object containing both secondMaxNumber and secondMaxIndex
            }

            function displayData(data) {
              const table = document.createElement('table');
              table.classList.add('table', 'table-borderless', 'datatable', 'filled-table', 'table-striped');

              const thead = document.createElement('thead');
              const headerRow = document.createElement('tr');

              const tbody = document.createElement('tbody');

              const maxValues = Array.from({ length: 5 }, () => -Infinity);
              let maxIndex;
              let secondMaxIndex;
              data.forEach((row, index) => {

                if (index === 0) {

                  const numbers = [row[2], row[3], row[4], row[5], row[6], row[7]];
                  const { maxNumber } = findMaxNumberWithIndex(numbers);
                  maxIndex = findMaxNumberWithIndex(numbers).maxIndex

                  const { secondMaxNumber } = findSecondMaxNumberWithIndex(numbers);
                  secondMaxIndex = findSecondMaxNumberWithIndex(numbers).secondMaxIndex

                  document.getElementById('form45-party-01-stats').innerHTML = maxNumber
                  document.getElementById('form45-party-02-stats').innerHTML = secondMaxNumber

                  headerRow.innerHTML = `
                    <th scope="col">${row[0]}</th>
                    <th scope="col">${row[1]}</th>
                    <th scope="col">${row[2]}</th>
                    <th scope="col">${row[3]}</th>
                    <th scope="col">${row[4]}</th>
                    <th scope="col">${row[5]}</th>
                    <th scope="col">${row[6]}</th>
                    <th scope="col">${row[7]}</th>
                  `;

                  thead.appendChild(headerRow);
                  table.appendChild(thead);
                  return
                };

                if (index === 1) {

                  document.getElementById('form45-party-01-name').innerHTML = row[maxIndex + 2]
                  document.getElementById('form45-party-02-name').innerHTML = row[secondMaxIndex + 2]
                }






                const isAllUndefined = row.every(value => value === undefined);
                if (!isAllUndefined) {
                  const tr = document.createElement('tr');




                  if (index < 2) {
                    tr.style.fontWeight = 'bold';
                  }




                  tr.innerHTML = `
                          <th scope="row"><a href="#">${row[0] || ''}</a></th>
                          <td >${row[1] || ''}</td>
                          <td style=${row[2] > row[3] && row[2] > row[4] && row[2] > row[5] && row[2] > row[6] && row[2] > row[7] && [0, 1].includes(index) == false && "background-color:lightgreen;"}>${row[2] || ''}</td>
                          <td style=${row[3] > row[2] && row[3] > row[4] && row[3] > row[5] && row[3] > row[6] && row[3] > row[7] && [0, 1].includes(index) == false && "background-color:lightgreen;"} > ${row[3] || ''}</td>
                          <td style=${row[4] > row[2] && row[4] > row[3] && row[4] > row[5] && row[4] > row[6] && row[4] > row[7] && [0, 1].includes(index) == false && "background-color:lightgreen;"}>${row[4] || ''}</td>
                          <td style=${row[5] > row[2] && row[5] > row[3] && row[5] > row[4] && row[5] > row[6] && row[5] > row[7] && [0, 1].includes(index) == false && "background-color:lightgreen;"}>${row[5] || ''}</td>
                          <td style=${row[6] > row[2] && row[6] > row[3] && row[6] > row[4] && row[6] > row[5] && row[6] > row[7] && [0, 1].includes(index) == false && "background-color:lightgreen;"} >${row[6] || ''}</td>
                          <td style=${row[7] > row[2] && row[7] > row[3] && row[7] > row[4] && row[7] > row[5] && row[7] > row[6] && [0, 1].includes(index) == false && "background-color:lightgreen;"}>${row[7] || ''}</td>
                        `;

                  tbody.appendChild(tr);
                }
              });
              table.appendChild(tbody);


              // Display the table in the recent sales section
              const recentSalesSection = document.querySelector('.table-main');
              recentSalesSection.innerHTML = '';
              recentSalesSection.appendChild(table);
            }


          </script>
        </div><!-- End Left side columns -->

        <!-- Right side columns -->

      </div>
    </section>

  </main><!-- End #main -->

  <!-- ======= Footer ======= -->
  <footer id="footer" class="footer">

    <div class="credits">

      by <a href="#">PTI</a>
    </div>
  </footer><!-- End Footer -->

  <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short"></i></a>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/chart.js/chart.umd.js"></script>
  <script src="assets/vendor/echarts/echarts.min.js"></script>
  <script src="assets/vendor/quill/quill.min.js"></script>
  <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
  <script src="assets/vendor/tinymce/tinymce.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>

  <!-- Template Main JS File -->
  <script src="assets/js/main.js"></script>

</body>

</html>